<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>6æšãƒ‡ãƒƒã‚­ â†’ 3æšæ‰‹æœ­ ãƒ‡ãƒ¢</title>
<style>
  :root{
    --bg:#0f1724;
    --card-bg:#fff;
    --muted:#9aa4b2;
    --accent:#2dd4bf;
  }
  html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;background:linear-gradient(180deg,#071428 0%,var(--bg) 100%);color: #e6eef6;}
  .app{
    max-width:860px;margin:40px auto;padding:24px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    box-shadow: 0 6px 30px rgba(2,6,23,0.6);
  }
  header{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px}
  header h1{font-size:18px;margin:0}
  .controls{display:flex;gap:8px}
  button{
    background:transparent;border:1px solid rgba(255,255,255,0.08);padding:8px 12px;border-radius:8px;color:inherit;cursor:pointer;font-weight:600;
  }
  button.primary{background:linear-gradient(90deg,var(--accent),#60a5fa);color:#052023;border:none}
  .board{display:flex;gap:18px;flex-wrap:wrap}
  .panel{flex:1;min-width:260px;background:rgba(255,255,255,0.02);padding:16px;border-radius:10px}
  .panel h2{margin:0 0 12px 0;font-size:14px;color:var(--muted)}
  .deck-area{display:flex;flex-direction:column;gap:12px;align-items:flex-start}
  .deck-count{font-size:12px;color:var(--muted)}
  .deck-card{
    width:120px;height:160px;border-radius:10px;background:linear-gradient(180deg,#0ea5a5,#60a5fa);display:flex;align-items:center;justify-content:center;font-size:40px;color:#052023;
    box-shadow:0 8px 18px rgba(2,6,23,0.5);border:4px solid rgba(255,255,255,0.08);
  }
  .hand{display:flex;gap:12px;align-items:flex-start;flex-wrap:wrap}
  .card{
    width:120px;height:160px;border-radius:10px;background:var(--card-bg);color:#052023;display:flex;flex-direction:column;align-items:center;justify-content:center;
    box-shadow: 0 6px 20px rgba(2,6,23,0.35);font-weight:700;
  }
  .card .title{font-size:14px;margin-top:8px;color:#064; font-weight:700}
  .small{font-size:12px;color:var(--muted)}
  footer{margin-top:16px;font-size:13px;color:var(--muted);text-align:right}
  @media (max-width:640px){
    .deck-card,.card{width:96px;height:128px;font-size:34px}
  }
</style>
</head>
<body>
<div class="app" role="application" aria-label="ã‚«ãƒ¼ãƒ‰ãƒ‡ãƒ¢">
  <header>
    <h1>6æšãƒ‡ãƒƒã‚­ â†’ 3æšæ‰‹æœ­ ãƒ‡ãƒ¢</h1>
    <div class="controls">
      <button id="shuffleBtn">ã‚·ãƒ£ãƒƒãƒ•ãƒ«</button>
      <button class="primary" id="drawBtn">3æšã‚’å¼•ã</button>
      <button id="resetBtn">ãƒªã‚»ãƒƒãƒˆ</button>
    </div>
  </header>

  <div class="board">
    <section class="panel" aria-labelledby="deck-label">
      <h2 id="deck-label">ãƒ‡ãƒƒã‚­</h2>
      <div class="deck-area">
        <div id="deckVisual" class="deck-card" aria-hidden="true">ğŸ‚ </div>
        <div class="deck-count"><span id="deckCount">6</span> æš</div>
        <div class="small">æ®‹ã‚Šã®ã‚«ãƒ¼ãƒ‰</div>
      </div>
    </section>

    <section class="panel" aria-labelledby="hand-label">
      <h2 id="hand-label">æ‰‹æœ­</h2>
      <div id="hand" class="hand" role="list" aria-label="æ‰‹æœ­ã‚¨ãƒªã‚¢">
        <!-- ã‚«ãƒ¼ãƒ‰ãŒã“ã“ã«å…¥ã‚‹ -->
      </div>
      <div style="margin-top:10px" class="small">æ‰‹æœ­ã¯æœ€å¤§3æš</div>
    </section>

    <section class="panel" aria-labelledby="discard-label">
      <h2 id="discard-label">æ¨ã¦æœ­ / å±¥æ­´</h2>
      <div id="discard" class="hand" role="list" aria-label="æ¨ã¦æœ­ã‚¨ãƒªã‚¢"></div>
      <div class="small" style="margin-top:10px">å¼•ã‹ã‚ŒãŸã‚«ãƒ¼ãƒ‰ã®å±¥æ­´</div>
    </section>
  </div>

  <footer>ã‚«ãƒ¼ãƒ‰ã¯ç°¡å˜ã«å·®ã—æ›¿ãˆå¯èƒ½ã§ã™ã€‚JS ã® <code>initialDeck</code> ã‚’ç·¨é›†ã—ã¦ãã ã•ã„ã€‚</footer>
</div>

<script>
/*
  ãƒ‡ãƒ¢ã®ãƒ­ã‚¸ãƒƒã‚¯ï¼š
  - initialDeck: 6æšã®ã‚«ãƒ¼ãƒ‰ï¼ˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ {id,name,emoji}ï¼‰
  - shuffleDeck(): Fisher-Yatesã§ã‚·ãƒ£ãƒƒãƒ•ãƒ«
  - drawThree(): ãƒ‡ãƒƒã‚­ã«3æšä»¥ä¸Šã‚ã‚Œã°3æšæ‰‹æœ­ã¸ï¼ˆãƒ‡ãƒƒã‚­ã‹ã‚‰å‰Šé™¤ã—ã¦æ¨ã¦æœ­ã«æ®‹ã™ï¼‰
  - resetDeck(): å…ƒã«æˆ»ã™
*/

const initialDeck = [
  {id: 1, name: "ç‚ã®ä½¿è€…", emoji: "ğŸ”¥"},
  {id: 2, name: "æ°·ã®å®ˆè­·", emoji: "â„ï¸"},
  {id: 3, name: "é¢¨ã®æ—…äºº", emoji: "ğŸŒªï¸"},
  {id: 4, name: "å¤§åœ°ã®å·¨äºº", emoji: "â›°ï¸"},
  {id: 5, name: "å…‰ã®ç²¾éœŠ", emoji: "âœ¨"},
  {id: 6, name: "å½±ã®åˆºå®¢", emoji: "ğŸ—¡ï¸"}
];

let deck = [];
let hand = [];
let discard = [];

const deckCountEl = document.getElementById('deckCount');
const handEl = document.getElementById('hand');
const discardEl = document.getElementById('discard');
const shuffleBtn = document.getElementById('shuffleBtn');
const drawBtn = document.getElementById('drawBtn');
const resetBtn = document.getElementById('resetBtn');

function updateUI(){
  deckCountEl.textContent = deck.length;
  // æ‰‹æœ­è¡¨ç¤ºï¼ˆrole=list itemï¼‰
  handEl.innerHTML = '';
  hand.forEach(card => {
    const div = document.createElement('div');
    div.className = 'card';
    div.setAttribute('role','listitem');
    div.innerHTML = `<div style="font-size:48px">${card.emoji}</div><div class="title">${card.name}</div>`;
    // å³ã‚¯ãƒªãƒƒã‚¯ã§ã‚«ãƒ¼ãƒ‰ã‚’æ¨ã¦ã‚‹ï¼ˆä¾‹ï¼‰
    div.addEventListener('contextmenu', e => { e.preventDefault(); discardCard(card.id); });
    handEl.appendChild(div);
  });
  // æ¨ã¦æœ­
  discardEl.innerHTML = '';
  discard.forEach(card => {
    const d = document.createElement('div');
    d.className = 'card';
    d.style.opacity = 0.88;
    d.setAttribute('role','listitem');
    d.innerHTML = `<div style="font-size:40px">${card.emoji}</div><div class="title">${card.name}</div>`;
    discardEl.appendChild(d);
  });

  // ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹åˆ¶å¾¡
  drawBtn.disabled = deck.length < 3;
  shuffleBtn.disabled = deck.length === 0;
}

// Fisher-Yates ã‚·ãƒ£ãƒƒãƒ•ãƒ«ï¼ˆã‚¤ãƒ³ãƒ—ãƒ¬ãƒ¼ã‚¹ï¼‰
function shuffleArray(arr){
  for(let i = arr.length - 1; i > 0; i--){
    // ãƒ©ãƒ³ãƒ€ãƒ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆ0..iï¼‰
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

function shuffleDeck(){
  deck = shuffleArray(deck);
  updateUI();
}

// å¼•ãï¼ˆ3æšï¼‰
// å¼•ã„ãŸã‚«ãƒ¼ãƒ‰ã¯æ‰‹æœ­ã«å…¥ã‚Œã‚‹ï¼ˆæ—¢ã«æ‰‹æœ­ãŒã‚ã‚‹å ´åˆã¯ä¸Šæ›¸ãã§ã¯ãªãè¿½åŠ ï¼‰
// ã“ã“ã§ã¯æ‰‹æœ­ä¸Šé™ã‚’3æšã«ã—ã¦ã€è¶…ãˆãªã„ã‚ˆã†ã«ã™ã‚‹
function drawThree(){
  if(deck.length < 3) return;
  // æ—¢ã«æ‰‹æœ­ãŒã‚ã‚‹å ´åˆã¯å…ˆã«æ‰‹æœ­ã‚’æ¨ã¦æœ­ã¸ï¼ˆã‚²ãƒ¼ãƒ ä»•æ§˜æ¬¡ç¬¬ã§å¤‰æ›´å¯ï¼‰
  // ä»Šå›ã¯ã€Œæ–°ã—ã„æ‰‹æœ­ã‚’å®Œå…¨ã«å…¥ã‚Œæ›¿ãˆã‚‹ã€å‹•ä½œã«ã™ã‚‹
  while(hand.length) {
    discard.push(hand.pop());
  }
  const drawn = deck.splice(0, 3); // å±±ã®ä¸Šã‹ã‚‰3æš
  hand = drawn.slice(); // æ‰‹æœ­ã«
  // å¼•ã„ãŸã‚«ãƒ¼ãƒ‰ã¯æ¨ã¦æœ­å±¥æ­´ã«ã‚‚æ®‹ã™ï¼ˆå±¥æ­´ã¨ã—ã¦ï¼‰
  // â€» æ—¢ã«ä¸Šã§å…¨æ‰‹æœ­ã‚’æ¨ã¦ãŸã®ã§å±¥æ­´ã«ã¯æ®‹ã‚‰ãªã„ã€‚ä»£ã‚ã‚Šã«å±¥æ­´ã«è¿½åŠ ã™ã‚‹ãƒ‡ã‚¶ã‚¤ãƒ³ã«
  discard = discard.concat(drawn.map(c => ({...c})));
  updateUI();
}

function discardCard(cardId){
  // æ‰‹æœ­ã‹ã‚‰å€‹åˆ¥ã«æ¨ã¦ã‚‹ï¼ˆå³ã‚¯ãƒªãƒƒã‚¯ã§å‘¼ã°ã‚Œã‚‹ï¼‰
  const idx = hand.findIndex(c => c.id === cardId);
  if(idx === -1) return;
  const [removed] = hand.splice(idx,1);
  discard.push(removed);
  updateUI();
}

function resetDeck(){
  deck = initialDeck.map(c => ({...c}));
  hand = [];
  discard = [];
  updateUI();
}

// åˆæœŸåŒ–
resetDeck();

// ã‚¤ãƒ™ãƒ³ãƒˆ
shuffleBtn.addEventListener('click', () => {
  shuffleDeck();
});
drawBtn.addEventListener('click', () => {
  drawThree();
});
resetBtn.addEventListener('click', () => {
  resetDeck();
  shuffleDeck();
});

/* --- è¿½åŠ æ¡ˆå†…ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆï¼‰---
 - ã‚«ãƒ¼ãƒ‰ã«ç”»åƒã‚’ä½¿ã†å ´åˆã¯ initialDeck ã®è¦ç´ ã« image: "url" ã‚’è¿½åŠ ã—ã¦
   card.innerHTML ã‚’ <img src="..."> ã«å·®ã—æ›¿ãˆã¦ãã ã•ã„ã€‚
 - ã‚µãƒ¼ãƒãƒ¼ã§ãƒ‡ãƒƒã‚­ã‚’ç®¡ç†ã™ã‚‹ãªã‚‰ fetch() ã§ API ã¨åŒæœŸã•ã›ã‚‹ã¨è‰¯ã„ã§ã™ã€‚
 - ã‚«ãƒ¼ãƒ‰åŠ¹æœã‚„ã‚¯ãƒªãƒƒã‚¯ã§ä½¿ç”¨ etc. ã‚’è¶³ã›ã°æœ¬æ ¼çš„ãªã‚²ãƒ¼ãƒ ã«ãªã‚Šã¾ã™ã€‚
*/
</script>
</body>
</html>
